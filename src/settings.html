<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Stats Overlay</title>
    <link rel="stylesheet" href="settings.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css"
        type='text/css'>
    <link rel="stylesheet" href="index.css">

    
</head>

<body>
    <div class = "page-title">
        <h1>Settings</h1>
    </div>
    <form onsubmit="submitHandle()">
        <div id="contrastSlider" class = "opacity settings">
            <h3>Opacity</h3>
            <input id="contrast" type="range" value="contrast" max=".5" min="0" step="0.001"/>
        </div>
        <!-- <div class = "settings color">
            <h3>Background Color</h3>
            <input type="color" id="head" name="head"
                   value="#e66465">
        </div> -->
        <div class = "settings client-settings">
            <h3>Client</h3>
            <select name="Client" id="Client">
              <option value="lunar">Lunar Client</option>
              <option value="badlion">Badlion Client</option>
              <option value="forge">Forge/Vanilla</option>
            </select>
            <div class="box">
                <span>Custom Path</span>
                <input type="file" name="logfile" accept=".log" onsubmit="customLogPath()" title= "Custom Path" value = "Custom Path">
            </div>
            
            
        </div>
        <div class = "settings blur" id = "apiDiv" onclick="removeBlur()">
            <h3>API Key</h3>
            <input class = "blur" type="text" id="API" name="apiInput"
                   value="">
        </div>
        <div class = "settings buttons">
            <button type="button" id= "saveButton" class="btn btn-success">Save</button>
            <button type="button" id = "cancelButton" class="btn btn-danger">Cancel</button>
        </div>
    </form>
    












    <div id="sidebar">
        <div class="toggle-btn" onclick="show()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul>
            <li>
                <form action="bedwars.html">
                    <button>Bedwars</button>
                </form>
            </li>
            <li>
                <form action="bridge.html">
                    <button>Bridge</button>
                </form>
            </li>
            <li>
                <form action="skywars.html">
                    <button>Skywars</button>
                </form>
            </li>
            <li>
                <form action="search.html">
                    <button>Search</button>
                </form>
            </li>
            <li>
                <form action="settings.html">
                    <button>Settings</button>
                </form>

            </li>
            <li>
                <form action="index.html">
                    <button>Select Client</button>
                </form>
            </li>
        </ul>
    </div>
    <script>
        function show() {
            document.getElementById("sidebar").classList.toggle('active');
        }
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="backgroundOpacity.js"></script>
    <!-- <script type="text/javascript">
        $(document).ready(function() {
            var path = require("path")
            const filename = path.resolve(__dirname, "data.json");
            var file_content = fs.readFileSync(filename);
            var content = JSON.parse(file_content);
            $('body').css('background', content.background);
        });
    </script> -->

    <script type="text/javascript">
        $('#contrast').on('input', function() {
            $('body').css('background', "rgba(0,0,0, " + $(this).val() + ")");
        });
        //console.log(key);
    </script>

    
   
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', (event) => {
            path = require("path");
            fs = require("fs");
            const filename = path.resolve(__dirname, "data.json");
            var file_content = fs.readFileSync(filename);
            var content = JSON.parse(file_content);
            apiInput = document.getElementById("API")
            apiInput.value = content.api_key;

            const opacitySlider = document.getElementById("contrast")
            var val = content.background.substring(content.background.length - 6);
            console.log(parseFloat(val.substring(0,5)))
            opacitySlider.value = parseFloat(val.substring(0,5))
        })

        function removeBlur(){
            //zconsole.log("bobahdl;isugkhjasd;ol")
            apiInput = document.getElementById("apiDiv")
            apiInput.classList.remove("blur");
            apiInput.classList.add("clear");
            console.log(apiInput.classList);
        }
        document.getElementById("saveButton").addEventListener("click", function(event){
            event.preventDefault()
            submitHandler();
        });

        function submitHandler(){
            console.log("submit")
            var path = require("path")
            var fs = require("fs")
            const filename = path.resolve(__dirname, "data.json");
            var file_content = fs.readFileSync(filename);
            var content = JSON.parse(file_content);
            console.log(content)
            var val = document.getElementById("contrast").value
            content.background = "rgba(0,0,0, " + val + ")"

            fs.writeFile(filename, JSON.stringify(content), function writeJSON(err) {
              if (err) return console.log(err);
            });
            location.reload();
        }
    </script>
</body>
</html>