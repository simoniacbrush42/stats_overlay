<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Stats Overlay</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="searched_stats.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css"
        type='text/css'>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.min.js"
        integrity="sha384-skAcpIdS7UcVUC05LJ9Dxay8AXcDYfBJqt1CJ85S/CFujBsIzCIv+l9liuYLaMQ/"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class = "background">
        <div class = "container">
            <div class = "generic_info">
                <section>
                    <h3>Network</h3>
                    <ul>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </section>
            </div>
            <div class = "sections">
                <section>
                    <h3>Bedwars</h3>
                    <ul>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </section>
                <section>
                    <h3>SkyWars</h3>
                    <ul>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </section>
                <section>
                    <h3>Duels</h3>
                    <ul>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </section>
            </div>
            
            
            
        </div>
    </div>
    <div id="sidebar">
        <div class="toggle-btn" onclick="show()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul>
            <li>
                <form action="bedwars.html">
                    <button>Bedwars</button>
                </form>
            </li>
            <li>
                <form action="bridge.html">
                    <button>Bridge</button>
                </form>
            </li>
            <li>
                <form action="search.html">
                    <button>Search</button>
                </form>
            </li>
            <li>
                <form action="settings.html">
                    <button>Settings</button>
                </form>

            </li>
        </ul>
    </div>
    

    <script>
        function show() {
            document.getElementById("sidebar").classList.toggle('active');
        }
    </script>

    <script>
        window.addEventListener('DOMContentLoaded', function() {
            var string_stats = sessionStorage.getItem("stats")
            var player = JSON.parse(string_stats)
            //console.log(player)

            //image area

            let name = player.displayname
            let last_login = player.lastLogin

            //bedwars area

            let star = player.achievements.bedwars_level
            let bw_ws = player.stats.Bedwars.winstreak
            let finals = player.stats.Bedwars.final_kills_bedwars
            let final_deaths = player.stats.Bedwars.final_deaths_bedwars
            let fkdr;
            if (!final_deaths) {
                fkdr = finals
            } else {
                fkdr = (finals / final_deaths).toFixed(2)
            }

            //sw area
            let sw_lvl = sw_xp_to_lvl(player.stats.SkyWars.skywars_experience)
            let sw_winstreak = player.stats.SkyWars.win_streak
            let wins = player.stats.SkyWars.wins
            let losses = player.stats.SkyWars.losses
            let sw_wlr;

            if (wins && losses){
                sw_wlr = (wins/losses).toFixed(2)
            }else if (wins && !losses){
                sw_wlr = wins
            }else{
                sw_wlr = 0
            }
            console.log(sw_lvl)



            //duels area

            let duels_ws = player.stats.Duels.current_winstreak
            let duels_wins = player.stats.Duels.wins
            let duels_losses = player.stats.Duels.losses
            let duels_wlr;
            if (duels_wins && duels_losses){
                duels_wlr = (duels_wins/duels_losses).toFixed(2)
            }else if (duels_wins && !duels_losses){
                duels_wlr = duels_wins
            }else{
                duels_wlr = 0
            }
        })

        function sw_xp_to_lvl(xp) {
            var xps = [0, 20, 70, 150, 250, 500, 1000, 2000, 3500, 6000, 10000, 15000];
            if(xp >= 15000) {
                return (xp - 15000) / 10000 + 12;
            } else {
                for(i = 0; i < xps.length; i++) {
                    if(xp < xps[i]) {
                        return i + (xp - xps[i-1]) / (xps[i] - xps[i-1]);
                    }
                }
            }
        }
    </script>
    

</body>

</html>